<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFC 3164/5424 Syslog Parser</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>RFC 3164/5424 Syslog Parser</h1>
            <p>Generate, parse and send syslog messages according to RFC 3164 & 5424 standards</p>
        </div>

        <div class="main-content">
            <div class="grid-layout">
                <!-- Left Column: Examples -->
                <div class="left-column">
                    <div class="section example-section">
                        <div class="section-header">
                            <h2 class="section-title">üìã Example Messages</h2>
                        </div>
                        <div class="section-body">
                            <div class="form-group">
                                <label for="exampleRfcVersion">RFC Version:</label>
                                <select id="exampleRfcVersion" onchange="updateExamples()">
                                    <option value="3164">RFC 3164</option>
                                    <option value="5424">RFC 5424</option>
                                </select>
                            </div>
                            
                            <div id="exampleMessages" class="example-messages">
                                <!-- Examples will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Center Column: Configuration -->
                <div class="center-column">
                    <!-- Message Configuration Section -->
                    <div class="section input-section">
                <div class="section-header">
                    <h2 class="section-title">‚öôÔ∏è Message Configuration</h2>
                    <button class="collapse-btn" onclick="toggleSection('messageConfig')" id="messageConfigToggle">
                        <span>‚ñº</span>
                    </button>
                </div>
                <div class="section-body" id="messageConfigBody">
                    <div class="form-group">
                        <label for="rfcVersion">RFC Version:</label>
                        <select id="rfcVersion" onchange="toggleRfcFields()">
                            <option value="3164">RFC 3164</option>
                            <option value="5424">RFC 5424</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="inputMode">Input Mode:</label>
                        <select id="inputMode" onchange="toggleInputMode()">
                            <option value="components">Message Components</option>
                            <option value="raw">Raw Message</option>
                        </select>
                    </div>
                    
                    
                    <!-- Raw Message Input (hidden by default) -->
                    <div id="rawInputSection" class="hidden">
                        <div class="form-group">
                            <label for="syslogMessage">Syslog Message:</label>
                            <textarea id="syslogMessage" placeholder="<Priority>Timestamp Hostname Tag[PID]: Message" rows="4"></textarea>
                        </div>
                    </div>
                    
                    <!-- Component Input Section -->
                    <div id="componentInputSection">
                        <!-- Basic Configuration -->
                        <div class="config-row">
                            <div class="config-group">
                                <label for="priority">Priority:</label>
                                <input type="number" id="priority" placeholder="Optional" min="0" max="191" class="tooltip" data-tooltip="Calculate from facility*8 + severity">
                            </div>
                            <div class="config-group">
                                <label for="facility">Facility:</label>
                                <input type="number" id="facility" placeholder="0-23" min="0" max="23" class="tooltip" data-tooltip="0=kernel, 4=security, 16=local0">
                            </div>
                            <div class="config-group">
                                <label for="severity">Severity:</label>
                                <input type="number" id="severity" placeholder="0-7" min="0" max="7" class="tooltip" data-tooltip="0=emergency, 4=warning, 6=info">
                            </div>
                        </div>
                        
                        <div class="config-row">
                            <div class="config-group">
                                <label for="timestamp">Timestamp:</label>
                                <input type="text" id="timestamp" placeholder="Auto-generated" class="tooltip" data-tooltip="RFC 3164: Oct 11 22:14:15 | RFC 5424: 2003-10-11T22:14:15.003Z">
                            </div>
                            <div class="config-group">
                                <label for="hostname">Hostname:</label>
                                <input type="text" id="hostname" placeholder="localhost" value="localhost">
                            </div>
                        </div>
                        
                        <!-- RFC 3164 specific fields -->
                        <div id="rfc3164Fields">
                            <div class="config-row">
                                <div class="config-group">
                                    <label for="tag">Tag:</label>
                                    <input type="text" id="tag" placeholder="app" value="app" class="tooltip" data-tooltip="Application or service name">
                                </div>
                                <div class="config-group">
                                    <label for="pid">Process ID:</label>
                                    <input type="number" id="pid" placeholder="PID" class="tooltip" data-tooltip="Process ID of the application">
                                </div>
                            </div>
                        </div>
                        
                        <!-- RFC 5424 specific fields -->
                        <div id="rfc5424Fields" class="hidden">
                            <div class="config-row">
                                <div class="config-group">
                                    <label for="appName">App Name:</label>
                                    <input type="text" id="appName" placeholder="app" value="app" class="tooltip" data-tooltip="Application name (RFC 5424)">
                                </div>
                                <div class="config-group">
                                    <label for="procId">Process ID:</label>
                                    <input type="text" id="procId" placeholder="ProcID" class="tooltip" data-tooltip="Process ID or thread ID">
                                </div>
                            </div>
                            <div class="config-row">
                                <div class="config-group">
                                    <label for="msgId">Message ID:</label>
                                    <input type="text" id="msgId" placeholder="MsgID" class="tooltip" data-tooltip="Message type identifier">
                                </div>
                                <div class="config-group">
                                    <label for="structuredData">Structured Data:</label>
                                    <input type="text" id="structuredData" placeholder='[exampleSDID@32473...]' class="tooltip" data-tooltip="RFC 5424 structured data elements">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="messageMode">Message Mode:</label>
                            <select id="messageMode" onchange="toggleMessageMode()">
                                <option value="text">Simple Text</option>
                                <option value="components">Key-Value Components</option>
                            </select>
                        </div>
                        
                        <div id="textMessageSection">
                            <div class="form-group">
                                <label for="message">Message:</label>
                                <textarea id="message" placeholder="Your log message here" rows="3"></textarea>
                            </div>
                        </div>
                        
                        <div id="componentMessageSection" class="hidden">
                            <div class="form-group">
                                <label for="messageComponents">Message Components (key=value format):</label>
                                <div id="messageComponents">
                                    <!-- Message components will be added here dynamically -->
                                </div>
                                <button type="button" class="btn btn-secondary btn-small" onclick="addMessageComponent()">
                                    ‚ûï Add Component
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Target Server Configuration -->
                    <div class="config-row">
                        <div class="config-group">
                            <label for="targetServer">Target Server:</label>
                            <input type="text" id="targetServer" placeholder="Server IP/Hostname" value="127.0.0.1">
                        </div>
                        <div class="config-group">
                            <label for="targetPort">Port:</label>
                            <input type="number" id="targetPort" placeholder="Port" value="5140" min="1" max="65535">
                        </div>
                        <div class="config-group">
                            <label for="protocol">Protocol:</label>
                            <select id="protocol">
                                <option value="udp">UDP</option>
                                <option value="tcp">TCP</option>
                            </select>
                        </div>
                    </div>

                    <!-- Transmission Configuration -->
                    <div class="config-row">
                        <div class="config-group">
                            <label for="transmissionCount">Transmission Count:</label>
                            <input type="number" id="transmissionCount" placeholder="1" value="1" min="1" max="10000" class="tooltip" data-tooltip="Number of times to send the message">
                        </div>
                        <div class="config-group">
                            <label for="transmissionDelay">Delay (ms):</label>
                            <input type="number" id="transmissionDelay" placeholder="100" value="100" min="0" max="10000" class="tooltip" data-tooltip="Delay between transmissions in milliseconds">
                        </div>
                        <div class="config-group">
                            <label for="unlimitedMode">Unlimited Mode:</label>
                            <input type="checkbox" id="unlimitedMode" onchange="toggleUnlimitedMode()" class="tooltip" data-tooltip="Send continuously until cancelled">
                        </div>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-primary" onclick="generateAndSend()" id="generateSendBtn">
                            <span id="generateSendBtnText">Generate & Send</span>
                            <span id="generateSendBtnLoader" class="loading hidden"></span>
                        </button>
                        <button class="btn btn-secondary" onclick="generateOnly()" id="generateBtn">
                            <span id="generateBtnText">Generate Only</span>
                            <span id="generateBtnLoader" class="loading hidden"></span>
                        </button>
                        <button class="btn btn-danger hidden" onclick="cancelTransmission()" id="cancelBtn">
                            Cancel Transmission
                        </button>
                    </div>
                    
                    <div id="rawModeButtons" class="button-group hidden">
                        <button class="btn btn-primary" onclick="parseAndSend()" id="sendBtn">
                            <span id="sendBtnText">Parse & Send</span>
                            <span id="sendBtnLoader" class="loading hidden"></span>
                        </button>
                        <button class="btn btn-secondary" onclick="parseOnly()" id="parseBtn">
                            <span id="parseBtnText">Parse Only</span>
                            <span id="parseBtnLoader" class="loading hidden"></span>
                        </button>
                    </div>
                </div>
            </div>
                
                <!-- Right Column: Results -->
                <div class="right-column">
                    <!-- Results Section -->
                    <div class="section result-section">
                        <div class="section-header">
                            <h2 class="section-title">üìä Results</h2>
                            <button class="collapse-btn" onclick="toggleSection('results')" id="resultsToggle">
                                <span>‚ñº</span>
                            </button>
                        </div>
                        <div class="section-body" id="resultsBody">
                            <div id="statusContainer" class="hidden">
                                <div id="statusMessage" class="status"></div>
                            </div>

                            <div id="resultContainer" class="hidden">
                                <div class="result-box">
                                    <h3>üìã Parsed Data</h3>
                                    <div id="parsedData" class="parsed-data"></div>
                                </div>
                            </div>

                            <div id="transmissionInfo" class="hidden">
                                <div class="result-box">
                                    <h3>üì§ Transmission Info</h3>
                                    <div id="transmissionDetails" class="parsed-data"></div>
                                </div>
                            </div>

                            <div id="saveExampleSection" class="hidden">
                                <div class="result-box">
                                    <h3>üíæ Save as Example</h3>
                                    <div class="save-example-form">
                                        <input type="text" id="exampleName" placeholder="Example name" required>
                                        <input type="text" id="exampleDescription" placeholder="Description (optional)">
                                        <button class="btn btn-secondary btn-small" onclick="saveCurrentExample()">
                                            Save Example
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Help Section -->
                            <div class="result-box help-section">
                                <h3>üí° Quick Help</h3>
                                <div class="help-content">
                                    <p><strong>Keyboard Shortcuts:</strong></p>
                                    <ul>
                                        <li><kbd>Ctrl+Enter</kbd> - Send/Generate message</li>
                                        <li><kbd>Ctrl+R</kbd> - Reset results</li>
                                    </ul>
                                    <p><strong>Facility Codes:</strong> 0=kernel, 4=security, 16=local0</p>
                                    <p><strong>Severity Levels:</strong> 0=emergency, 4=warning, 6=info</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>